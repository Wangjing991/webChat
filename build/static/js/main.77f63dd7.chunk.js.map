{"version":3,"sources":["components/Message/List/index.module.scss","components/Avatar/index.tsx","components/Message/List/Item.tsx","components/Message/List/ItemRight.tsx","components/Message/List/index.tsx","components/Input/index.tsx","components/Message/Editor/index.tsx","components/Button/index.tsx","pages/Home/flow.ts","pages/Home/index.tsx","services/transport.ts","services/login/index.ts","storage/userInfo.ts","store/global.ts","pages/Login/index.tsx","pages/Register/index.tsx","App.tsx","store/index.ts","index.tsx","components/Input/index.module.scss","components/Button/index.module.scss","components/Avatar/index.module.scss","pages/Home/style.module.scss","pages/Login/style.module.scss","pages/Register/style.module.scss","components/Message/Editor/index.module.scss"],"names":["module","exports","Avatar","loadAvatar","uid","this","props","src","cls","name","doNotUseDefault","i","className","classnames","styles","avatar","default","slice","React","Component","Item","msg","time","item","left","right","item_right","Editor","node","scrollIntoView","console","log","msgList","userId","len","length","container","map","it","user_id","ItemRight","username","id","ref","r","key","content","Input","input","saveInput","keyDownHandler","bind","ev","onPressEnter","onKeyDown","keyCode","focus","blur","prefix","suffix","clazz","ClassNames","affix_input","prefix_input","suffix_input","rest","value","defaultValue","renderAffixInput","handleChange","e","onChange","target","Button","clickHandler","onClick","disabledWhenLoading","loading","type","children","size","isGroup","htmlType","classNames","btn","in_group","iconfont","initialState","homeReducer","state","action","payload","concat","socket","io","process","Home","message","setState","sendMsg","emit","global","on","data","updateMsgList","window","location","href","mapDispatchToProps","str","asyncUpdateCount","count","dispatch","setTimeout","connect","homePage","axios","defaults","baseURL","interceptors","response","use","res","getAxios","url","get","params","userLogin","userRegister","cacheToken","setUserInfo","json","localStorage","setItem","JSON","stringify","userInfo","Object","keys","tokenString","getItem","parse","getUserInfo","userName","globalReducer","Login","a","async","status","updateUserId","user_info","history","push","alert","placeholder","style","marginBottom","to","float","withRouter","code","App","useSelector","useDispatch","exact","path","component","Register","reducers","combineReducers","store","createStore","applyMiddleware","thunk","createMyStore","TRS_STORE","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.77f63dd7.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"List_container__2OosZ\",\"item\":\"List_item__1y8N8\",\"left\":\"List_left__KqN5s\",\"right\":\"List_right__28ilk\",\"time\":\"List_time__v5igY\",\"item_right\":\"List_item_right__2jFlG\"};","import React from 'react'\nimport classnames from 'classnames'\n\nimport styles from './index.module.scss'\n\n\ninterface IProps {\n  uid?: number;\n  name?: string;\n  src?: string;\n  cls?: number | string;\n}\n\nclass Avatar extends React.Component<IProps, {}> {\n\n  loadAvatar = (uid: any) => {\n    return uid\n  }\n\n  render() {\n    const {src, cls, uid = 1, name} = this.props as any\n    let {doNotUseDefault} = this.props as any\n    const url = src || this.loadAvatar(uid)\n    src && (doNotUseDefault = true)\n    // 根据uid随机生成1-5\n    const i = (uid % 5) + 1\n    return (\n      <div className={classnames(styles.avatar, cls)}>\n        {!doNotUseDefault ?\n          (<div className={classnames(styles.default, `bg-r${i}`)}>{name && name.slice(-2)}</div>) :\n          null\n        }\n        {/*{src !== false ?*/}\n        {/*<div className={styles.bg} style={{background: `url(${url})`, backgroundSize: 'cover'}}/> :*/}\n        {/*null*/}\n        {/*}*/}\n      </div>\n    )\n  }\n}\n\nexport default Avatar\n","import React from 'react'\nimport classnames from 'classnames'\nimport Avatar from '../../Avatar'\nimport styles from './index.module.scss'\n\n\ninterface IProps {\n  uid?: number;\n  name?: string;\n  src?: string;\n  cls?: number | string;\n  msg: string;\n  time: string;\n}\n\nclass Item extends React.Component<IProps, {}> {\n\n  render() {\n    const {src, cls, uid, name, msg, time} = this.props as any\n\n    return (\n      <div className={styles.item}>\n        <Avatar cls={styles.left} name={name}/>\n        <div className={styles.right}>\n          <p className={styles.time}>{time}</p>\n          {msg}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Item\n","import React from 'react'\nimport classnames from 'classnames'\nimport Avatar from '../../Avatar'\nimport styles from './index.module.scss'\n\n\ninterface IProps {\n  uid?: number;\n  name?: string;\n  src?: string;\n  cls?: number | string;\n  msg: string;\n  time: string;\n}\n\nclass Item extends React.Component<IProps, {}> {\n\n  render() {\n    const {src, cls, uid, name, msg, time} = this.props as any\n\n    return (\n      <div className={styles.item_right}>\n        <div className={styles.right}>\n          <p className={styles.time}>{time}</p>\n          {msg}\n        </div>\n        <Avatar cls={styles.left} name={name}/>\n      </div>\n    )\n  }\n}\n\nexport default Item\n","import React from 'react'\nimport classnames from 'classnames'\nimport styles from './index.module.scss'\nimport Item from './Item'\nimport ItemRight from './ItemRight'\n\n\ninterface IProps {\n  uid?: number;\n  name?: string;\n  userId?: number;\n  msgList: string[];\n}\n\nclass Editor extends React.Component<IProps, {}> {\n  node: any;\n\n  componentDidUpdate() {\n\n    this.node && this.node.scrollIntoView && this.node.scrollIntoView()\n    console.log(this.node, '===this.node')\n  }\n\n  render() {\n    const {src, cls, uid, name} = this.props as any\n    let {msgList, userId} = this.props as any\n    const len = msgList.length\n    return (\n      <div className={styles.container}>\n        {\n          len ? msgList.map((it: any = {}) => {\n            return userId == it.user_id ?\n              <ItemRight time={it.time} name={it.username} uid={it.id} ref={r => this.node = r} key={it.id}\n                         msg={it.content}/> :\n              <Item time={it.time} name={it.username} uid={it.id} ref={r => this.node = r} key={it.id}\n                    msg={it.content}/>\n          }) : null\n        }\n      </div>\n    )\n  }\n}\n\nexport default Editor\n","import React, {Component} from 'react'\nimport ClassNames from 'classnames'\nimport styles from './index.module.scss'\n\nfunction fixControlledValue(value: any) {\n  // if (typeof value === 'undefined' || value === null) {\n  //   return ''\n  // }\n  return value\n}\n\ninterface IProps {\n  type?: string,\n  defaultValue?: string,\n  value?: string,\n  prefix?: any,\n  suffix?: any,\n  cls?: string,\n  style?: object,\n  placeholder?: string,\n  onPressEnter?: (e: any) => any,\n  onKeyDown?: (e: any) => any,\n  onChange?: (e: any) => any,\n}\n\nclass Input extends Component<IProps, any> {\n  input: any;\n\n  constructor(props: any) {\n    super(props)\n\n    this.keyDownHandler = this.keyDownHandler.bind(this)\n  }\n\n  keyDownHandler(ev: any) {\n    const {onPressEnter, onKeyDown} = this.props as any;\n    if (ev.keyCode === 13 && onPressEnter) {\n      onPressEnter(ev)\n    }\n\n    if (onKeyDown) {\n      onKeyDown(ev)\n    }\n  }\n\n  focus() {\n    this.input.focus()\n  }\n\n  blur() {\n    this.input.blur()\n  }\n\n  saveInput = (node: any) => {\n    this.input = node\n  }\n\n  renderAffixInput(props: any) {\n    const {prefix, suffix, cls} = this.props as any;\n    const clazz = ClassNames({\n      [styles.affix_input]: true,\n      [styles.prefix_input]: prefix,\n      [styles.suffix_input]: suffix\n    })\n\n    return (\n      <span className={clazz}>\n        {prefix ? <span className={styles.prefix}>{prefix}</span> : null}\n        <input ref={this.saveInput} className={ClassNames(styles.input, cls)} {...props} />\n        {suffix ? <span className={styles.suffix}>{suffix}</span> : null}\n      </span>\n    )\n  }\n\n  render() {\n    const {cls, prefix, suffix, ...rest} = this.props as any;\n\n    if ('value' in this.props) {\n      rest.value = fixControlledValue(this.props.value)\n      delete rest.defaultValue\n    }\n\n    if (prefix || suffix) {\n      return this.renderAffixInput(rest)\n    }\n\n    return (\n      <input ref={this.saveInput} className={ClassNames(styles.input, cls)}\n             {...rest} onKeyDown={this.keyDownHandler}/>\n    )\n  }\n}\n\n\n\nexport default Input\n","import React from 'react'\nimport Input from '../../Input'\nimport styles from './index.module.scss'\n\n\ninterface IProps {\n  uid?: number;\n  name?: string;\n  src?: string;\n  cls?: number | string;\n  onChange: (s: string) => {};\n}\n\nclass Editor extends React.Component<any, {}> {\n\n  handleChange = (e: any) => {\n    const {onChange} = this.props;\n    onChange && onChange(e.target.value)\n  }\n\n  render() {\n\n\n    return (\n      <div className={styles.container}>\n        <Input onChange={this.handleChange} value={this.props.value}/>\n      </div>\n    )\n  }\n}\n\nexport default Editor\n","import React, {Component} from 'react'\nimport classNames from 'classnames'\nimport styles from './index.module.scss'\n\nclass Button extends Component<any, any> {\n  constructor(props: any) {\n    super(props)\n\n    this.clickHandler = this.clickHandler.bind(this)\n  }\n\n  clickHandler() {\n    const {onClick, disabledWhenLoading, loading} = this.props as any;\n\n    if (loading && disabledWhenLoading) return\n\n    onClick && onClick()\n  }\n\n  render() {\n    const {type, loading, children, cls, size = 'middle', htmlType, isGroup, ...rest} = this.props as any;\n    const className = classNames(styles.btn, [styles[type]], [styles[size]], {\n      [styles.loading]: loading,\n      [styles.in_group]: isGroup\n    }, cls)\n    return (\n      <button className={className} onClick={this.clickHandler} {...rest}>\n        {loading ? <i className={classNames(styles.iconfont, styles['icon-loading'])}/> : null}\n        {children}\n      </button>\n    )\n  }\n}\n\n// Button.propTypes = {\n//   type: PropTypes.string,\n//   loading: PropTypes.bool,\n//   cls: PropTypes.string,\n//   size: PropTypes.string,\n//   htmlType: PropTypes.string,\n//   onClick: PropTypes.func,\n//   disabledWhenLoading: PropTypes.bool\n// }\n//\n// Button.defaultProps = {\n//   type: 'normal',\n//   loading: false,\n//   cls: '',\n//   size: 'middle',\n//   htmlType: 'button',\n//   onClick: noop,\n//   disabledWhenLoading: true\n// }\n//\n// Button.Group = Group\n\nexport default Button\n","import {Dispatch} from \"redux\";\nimport {IAction} from \"../../store/shared\";\nimport {string} from \"prop-types\";\n\nexport type UpdateMsgList = (count: string) => void;\nexport type AsyncUpdateCount = (count: number) => void;\n\nexport interface IHomePage {\n  msgList: string[];\n}\n\nconst HOME_UPDATE_COUNT = \"HOME_UPDATE_COUNT\";\n\n/**\n * 同步更新计数器\n * @param count number\n */\nexport const updateMsgList = (str: any) => {\n  return {\n    type: HOME_UPDATE_COUNT,\n    payload: str,\n  }\n}\n\n\n/**\n * 异步更新计数器\n * @param count number\n * @param dispatch Dispatch<IAction>\n */\nexport const asyncUpdateCount = (count: number) => (dispatch: Dispatch<IAction>) => {\n  setTimeout(() => {\n    const newCount = count + 1;\n    dispatch({\n      type: HOME_UPDATE_COUNT,\n      payload: newCount\n    })\n  }, 1000);\n}\n\nconst initialState: IHomePage = {\n  msgList: [],\n}\n\nconst homeReducer = (state = initialState, action: IAction) => {\n  const {type, payload} = action;\n  switch (type) {\n    case HOME_UPDATE_COUNT: {\n      const {msgList = []} = state\n      console.log(msgList.concat(payload), 'msgList.concat(payload)', payload)\n      return {\n        ...state, msgList: msgList.concat(payload)\n      };\n    }\n    default: {\n      return {...state};\n    }\n  }\n}\n\nexport default homeReducer;\n","import React from \"react\";\nimport {connect} from \"react-redux\";\nimport {IPageRoute} from \"../shared\";\nimport {IGlobal} from \"../../store/global\";\nimport {IStoreState} from \"../../store/shared\";\nimport Avatar from \"../../components/Avatar\";\nimport MessageList from \"../../components/Message/List\";\nimport MessageEditor from \"../../components/Message/Editor\";\nimport Button from \"../../components/Button\";\nimport {\n  IHomePage,\n  UpdateMsgList,\n  AsyncUpdateCount,\n  updateMsgList,\n  asyncUpdateCount\n} from \"./flow\";\nimport io from \"socket.io-client\";\nimport styles from \"./style.module.scss\";\n\ninterface IProps extends IPageRoute<any>, IHomePage {\n  global: IGlobal;\n  updateMsgList: UpdateMsgList;\n  asyncUpdateCount: AsyncUpdateCount;\n}\n\nconst url = process.env.REACT_APP_API_URL || 'localhost:8003'\n\nconst socket = io(url)\n\nclass Home extends React.Component<IProps, any> {\n\n\n  state = {\n    message: ''\n  }\n\n  componentDidMount() {\n    socket.on('chat', (data: any) => {\n      console.log(data, 'socket-chat')\n      this.props.updateMsgList(data)\n      this.setState({\n        message: ''\n      })\n    });\n    if (!this.props.global.userId) {\n      window.location.href = '#/login'\n    }\n  }\n\n  handleChange = (value: string) => {\n    this.setState({\n      message: value\n    })\n  }\n  sendMsg = () => {\n    const msg = this.state.message\n    socket.emit('chat', {user_id: this.props.global.userId, content: msg});\n  }\n\n\n  render() {\n    const {msgList, global} = this.props\n    return (\n      <div className={styles.container}>\n        <MessageList msgList={msgList} userId={global.userId}/>\n        <MessageEditor onChange={this.handleChange} value={this.state.message}/>\n        <div className={styles.btn}>\n          <Button type=\"primary\" size=\"small\" onClick={this.sendMsg}>发送</Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IStoreState) => ({\n  global: state.global,\n  ...state.homePage\n});\n\nconst mapDispatchToProps = {\n  updateMsgList,\n  asyncUpdateCount\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Home);\n","import axios, {AxiosRequestConfig} from \"axios\";\nimport {getToken} from \"./authorization\";\n\nconst {REACT_APP_API_URL} = process.env;\n\naxios.defaults.baseURL = REACT_APP_API_URL\n\naxios.interceptors.response.use(res => {\n  console.log(res, 'axios.interceptors')\n  return res.data\n})\nconst getAxios = (url: string, data?: any) => {\n  return axios.get(url, {params: data})\n}\n\nconst service = (params: AxiosRequestConfig, token?: string) => {\n  if (token) {\n    const {headers = {}} = params;\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  return axios(params);\n}\n\nconst transport = (params: AxiosRequestConfig) => {\n  const token = getToken();\n  if (token) {\n    return service(params, token);\n  } else {\n    return service(params);\n  }\n}\n\nexport {getAxios};\n\nexport default transport;\n","import transport, {getAxios} from \"../transport\";\n\n/**\n * 获取所有测试\n */\nexport const userLogin = (data: any) => {\n  return getAxios('user/login', data);\n}\n\nexport const userRegister = (data: any) => {\n  return getAxios('user/register', data);\n}\n\n","let cacheToken: object = {};\n\nconst LOCAL_STORAGE_USERINFO = \"LOCAL_STORAGE_USERINFO\";\n\nexport const getUserInfo = (): object => {\n  if (Object.keys(cacheToken).length) {\n    return cacheToken;\n  }\n  const tokenString = localStorage.getItem(LOCAL_STORAGE_USERINFO);\n  if (tokenString) {\n    try {\n      const json = JSON.parse(tokenString);\n      cacheToken = json;\n      return cacheToken;\n    } catch (e) {\n    }\n  }\n  return {};\n}\n\nexport const removeUserInfo = () => {\n  cacheToken = {};\n  localStorage.removeItem(LOCAL_STORAGE_USERINFO);\n}\n\nexport const setUserInfo = (json: object) => {\n  cacheToken = json;\n  localStorage.setItem(LOCAL_STORAGE_USERINFO, JSON.stringify(json));\n}\n","import {IAction} from \"./shared\";\nimport {getUserInfo, setUserInfo} from \"../storage/userInfo\";\n\nexport type UpdateUserId = (userId: number, userName: string) => IAction<any>;\n\nexport interface IGlobal {\n  userId?: number;\n  userName?: string;\n}\n\nconst GLOBAL_UPDATE_USERID = \"GLOBAL_UPDATE_USERID\";\n\nexport const updateUserId = (userId: number, userName: string) => ({\n  type: GLOBAL_UPDATE_USERID,\n  payload: {userId, userName},\n});\n\nconst userInfo: IGlobal = getUserInfo()\nconsole.log(userInfo, 'userInfo')\nconst initialState: IGlobal = {\n    userId: userInfo.userId,\n    userName: userInfo.userName\n  }\n;\n\nconst globalReducer = (state = initialState, action: IAction) => {\n  const {type, payload} = action;\n  switch (type) {\n    case GLOBAL_UPDATE_USERID: {\n      setUserInfo(payload)\n      console.log(payload, 'payload')\n      return {...state, ...payload};\n    }\n    default: {\n      return {...state};\n    }\n  }\n}\n\nexport default globalReducer;\n","import React from \"react\";\nimport {connect} from \"react-redux\";\nimport {Link, withRouter} from \"react-router-dom\";\nimport {IPageRoute} from \"../shared\";\nimport {IGlobal} from \"../../store/global\";\nimport {IStoreState} from \"../../store/shared\";\nimport Input from \"../../components/Input\";\nimport Button from \"../../components/Button\";\nimport {userLogin} from \"../../services/login\";\nimport {UpdateUserId, updateUserId} from \"../../store/global\";\nimport styles from \"./style.module.scss\";\n\ninterface IProps extends IPageRoute<any> {\n  global: IGlobal;\n  updateUserId: UpdateUserId;\n}\n\ninterface FormData {\n  username: string;\n  password: string;\n}\n\nclass Login extends React.Component<IProps> {\n  data: any = {}\n  onClick = async () => {\n\n    console.log(this.props, 'location')\n    const res: any = await userLogin(this.data)\n    if (res.status === 200) {\n      this.props.updateUserId(res.user_info.id, res.user_info.name)\n      this.props.history.push('/')\n    }\n    alert(res && res.message)\n  }\n\n  onChange = (key: string, e: any) => {\n    this.data[key] = e.target.value\n    console.log(e.target.value, 'onChange')\n  }\n\n\n  render() {\n    return (\n      <div className={styles.container}>\n        <Input type=\"text\"\n               placeholder=\"用户名\"\n               onChange={this.onChange.bind(this, 'username')}\n               style={{marginBottom: '10px'}}/>\n        <Input type=\"password\"\n               placeholder=\"密码\"\n               onChange={this.onChange.bind(this, 'password')}\n               style={{marginBottom: '10px'}}/>\n        <Link to=\"/register\" style={{float: 'left'}}>立即注册</Link>\n        <div className={styles.btn}>\n          <Button type=\"primary\" size=\"small\" onClick={this.onClick}>登录</Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IStoreState) => ({\n  global: state.global,\n  ...state.homePage\n});\n\nconst mapDispatchToProps = {\n  updateUserId\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Login));\n","import React from \"react\";\nimport {connect} from \"react-redux\";\nimport {withRouter} from \"react-router-dom\";\nimport {IPageRoute} from \"../shared\";\nimport {IGlobal} from \"../../store/global\";\nimport {IStoreState} from \"../../store/shared\";\nimport Input from \"../../components/Input\";\nimport Button from \"../../components/Button\";\nimport {userRegister} from \"../../services/login\";\nimport styles from \"./style.module.scss\";\n\ninterface IProps extends IPageRoute<any> {\n  global: IGlobal;\n}\n\ninterface FormData {\n  username: string;\n  password: string;\n}\n\nclass Home extends React.Component<IProps> {\n  data: any = {}\n  onClick = async () => {\n    let {history} = this.props\n    const res: any = await userRegister(this.data)\n    if (res.code !== 0) {\n      history.push('./login')\n    }\n    // alert(res && res.message)\n  }\n\n  onChange = (key: string, e: any) => {\n    this.data[key] = e.target.value\n    console.log(e.target.value, 'onChange')\n  }\n\n\n  render() {\n    return (\n      <div className={styles.container}>\n        <Input type=\"text\"\n               placeholder=\"用户名\"\n               onChange={this.onChange.bind(this, 'username')}\n               style={{marginBottom: '10px'}}/>\n        <Input type=\"password\"\n               placeholder=\"密码\"\n               onChange={this.onChange.bind(this, 'password')}\n               style={{marginBottom: '10px'}}/>\n        <div className={styles.btn}>\n          <Button type=\"primary\" size=\"small\" onClick={this.onClick}>注册</Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IStoreState) => ({\n  global: state.global,\n  ...state.homePage\n});\n\nconst mapDispatchToProps = {}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Home));\n","import React from \"react\";\nimport {useSelector, useDispatch} from \"react-redux\";\nimport {HashRouter as Router, Route, Redirect} from \"react-router-dom\";\nimport {IStoreState} from \"./store/shared\";\nimport {updateUserId} from \"./store/global\";\nimport Home from \"./pages/Home/index\";\nimport Login from \"./pages/Login/index\";\nimport Register from \"./pages/Register/index\";\n\nconst App = () => {\n  const global = useSelector((state: IStoreState) => ({\n    ...state.global\n  }));\n  const dispatch = useDispatch();\n  return (\n    <Router>\n      <Route exact path=\"/\" component={Home}></Route>\n      <Route exact path=\"/login\" component={Login}></Route>\n      <Route exact path=\"/register\" component={Register}></Route>\n    </Router>\n  )\n}\n\nexport default App;\n","import { createStore, combineReducers, applyMiddleware, compose } from \"redux\";\nimport logger from \"redux-logger\";\nimport thunk from \"redux-thunk\"\nimport globalReducer from \"./global\";\nimport homeReducer from \"../pages/Home/flow\";\nimport { IStoreState } from \"./shared\";\n\nconst reducers = combineReducers<IStoreState>({\n  global: globalReducer,\n  homePage: homeReducer,\n});\n\nconst createMyStore = () => {\n  const store = process.env.REACT_APP_RUN_MODE === \"production\" ? (\n    createStore(reducers, applyMiddleware(thunk))\n  ) : (\n    window.__REDUX_DEVTOOLS_EXTENSION__? (\n      createStore(reducers, compose(applyMiddleware(thunk, logger), window.__REDUX_DEVTOOLS_EXTENSION__({})))\n    ) : (\n      createStore(reducers, applyMiddleware(thunk, logger))\n    )\n  );\n  return store;\n}\n\nexport default createMyStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport createMyStore from \"./store\";\n// import * as serviceWorker from './serviceWorker';\n\nconst store = createMyStore();\n\nwindow.TRS_STORE = store;\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"Input_input__SCFHN\",\"affix_input\":\"Input_affix_input__3kubb\",\"prefix_input\":\"Input_prefix_input__1Q-wP\",\"prefix\":\"Input_prefix__3QSE6\",\"suffix_input\":\"Input_suffix_input__2ZxwZ\",\"suffix\":\"Input_suffix__2pHyS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconfont\":\"Button_iconfont__3zoME\",\"icon-loading\":\"Button_icon-loading__FO-eS\",\"loadingCircle\":\"Button_loadingCircle__StONJ\",\"btn\":\"Button_btn__1iklE\",\"normal\":\"Button_normal__gxfXj\",\"loading\":\"Button_loading___7u6u\",\"in_group\":\"Button_in_group__2KFD1\",\"primary\":\"Button_primary__3U5oy\",\"text\":\"Button_text__3UvNg\",\"small\":\"Button_small__4DYQu\",\"middle\":\"Button_middle__6OBa8\",\"large\":\"Button_large__1K9uC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar\":\"Avatar_avatar__TDntD\",\"bg\":\"Avatar_bg__2X89u\",\"default\":\"Avatar_default__sg-TN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"style_container__1WWpg\",\"btn\":\"style_btn__3sneX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"style_container__3UGcz\",\"btn\":\"style_btn__2MiBi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"style_container__1pcsJ\",\"btn\":\"style_btn__2i1Ww\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Editor_container__-do5t\"};"],"sourceRoot":""}